[
  {
    "id": "272a501ef33781479e86c4e04724719e",
    "type": "callout",
    "parentId": "272a501ef337811c8b94c8697bb7dcfa",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "color": "default_background",
      "icon": {
        "type": "external",
        "external": {
          "url": "https://www.notion.so/icons/code_gray.svg"
        }
      },
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "main.py",
          "href": null
        }
      ]
    },
    "order": 0
  },
  {
    "id": "272a501ef33781cd9365d00f594640a1",
    "type": "code",
    "parentId": "272a501ef33781479e86c4e04724719e",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "caption": [],
      "language": "python",
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "import flet as ft\nfrom db import init_db\nfrom lib.controllers import todoController as con\n\ndef main(page: ft.Page):\n\t\tinit_db()\n    appbar = ft.AppBar(\n        center_title=True,\n        title=ft.Text(value=\"TODOアプリ\"),\n        bgcolor=ft.Colors.BLACK12\n    )\n\n    def route_change(e):\n        template_route = ft.TemplateRoute(page.route)\n\n        if template_route.match(\"/create\"):\n            createTextField = ft.TextField(hint_text=\"TODO\")\n            appbar.leading = ft.IconButton(icon=ft.Icons.ARROW_BACK, on_click=lambda _:page.go(\"/\"))\n            page.views.append(\n                ft.View(\n                    \"/create\",\n                    appbar=appbar,\n                    controls=[\n                        ft.Text(\"TODO作成\"),\n                        createTextField,\n                        ft.ElevatedButton(text=\"作成\",on_click=lambda e:con.create_todo(e, createTextField.value, page))\n                    ]\n                )\n            )\n        elif template_route.match(\"/\"):\n            appbar.leading = ft.Text(\"\")\n            floating_button = ft.FloatingActionButton(\n                icon=ft.Icons.ADD,\n                bgcolor=ft.Colors.BLUE_200,\n                on_click=lambda _: page.go(\"/create\")\n            )\n            con.fetch_todo(page)\n            page.views.append(\n                ft.View(\n                    \"/\",\n                    appbar=appbar,\n                    controls=[con.todo_list_control],\n                    floating_action_button=floating_button\n                )\n            )\n        page.update()\n\n    page.on_route_change = route_change\n    page.go(page.route)\n\nft.app(main)",
          "href": null
        }
      ]
    },
    "order": 0
  },
  {
    "id": "272a501ef337816ba0ccd9fc093e638b",
    "type": "callout",
    "parentId": "272a501ef337811c8b94c8697bb7dcfa",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "color": "default_background",
      "icon": {
        "type": "external",
        "external": {
          "url": "https://www.notion.so/icons/code_gray.svg"
        }
      },
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "todoController.py",
          "href": null
        }
      ]
    },
    "order": 1
  },
  {
    "id": "272a501ef33781758311c7769833b3be",
    "type": "code",
    "parentId": "272a501ef337816ba0ccd9fc093e638b",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "caption": [],
      "language": "python",
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "import flet as ft\nfrom lib.models import todoGateway as gate\nfrom lib.models.todoModel import Todo\n\ntodo_list_control = ft.Column()\n\ndef create_todo(e, task, page):\n    gate.save_todo(task)\n    page.go(\"/\")\n\ndef fetch_todo(page):\n    rows = gate.get_todo()\n    todo_list = []\n    for row in rows:\n        todo = Todo(id=row[0],task=row[1],isAchieved=row[2] == 1,created_at=row[3])\n        todo_list.append(todo)\n    controls = []\n    for todo in todo_list:\n        text = ft.Text(todo.task)\n        checkbox = ft.Checkbox(on_change=lambda e, isAchieved=todo.isAchieved, id=todo.id:check_todo(e, isAchieved, id, page))\n        if todo.isAchieved:\n            text.style = ft.TextStyle(decoration=ft.TextDecoration.LINE_THROUGH)\n            checkbox.value = todo.isAchieved\n        controls.append(\n            ft.Row([\n                checkbox,\n                text,\n                ft.IconButton(icon=ft.Icons.DELETE,on_click=lambda e,id=todo.id: delete_todo(e, id, page))\n            ]))\n    todo_list_control.controls = controls\n    page.update()\n\ndef delete_todo(e, id, page):\n    gate.delete_todo(id)\n    fetch_todo(page)\n\ndef check_todo(e, isAchieved, id, page):\n    if isAchieved:\n        isAchieved = 0\n    else:\n        isAchieved = 1\n    gate.check_todo(isAchieved, id)\n    fetch_todo(page)",
          "href": null
        }
      ]
    },
    "order": 0
  },
  {
    "id": "272a501ef3378198aa6be19a12b98d37",
    "type": "callout",
    "parentId": "272a501ef337811c8b94c8697bb7dcfa",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "color": "default_background",
      "icon": {
        "type": "external",
        "external": {
          "url": "https://www.notion.so/icons/code_gray.svg"
        }
      },
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "todoModel.py",
          "href": null
        }
      ]
    },
    "order": 2
  },
  {
    "id": "272a501ef3378166afd9e70eb3250ebb",
    "type": "code",
    "parentId": "272a501ef3378198aa6be19a12b98d37",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "caption": [],
      "language": "python",
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "class Todo:\n    def __init__(self, id=0, task='', isAchieved=False, created_at =''):\n        self.id = id\n        self.task = task\n        self.isAchieved = isAchieved\n        self.created_at = created_at",
          "href": null
        }
      ]
    },
    "order": 0
  },
  {
    "id": "272a501ef337817a9cb3daede9089ad7",
    "type": "callout",
    "parentId": "272a501ef337811c8b94c8697bb7dcfa",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "color": "default_background",
      "icon": {
        "type": "external",
        "external": {
          "url": "https://www.notion.so/icons/code_gray.svg"
        }
      },
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "todoGateway.py",
          "href": null
        }
      ]
    },
    "order": 3
  },
  {
    "id": "272a501ef3378122a330ee9da3630b07",
    "type": "code",
    "parentId": "272a501ef337817a9cb3daede9089ad7",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "caption": [],
      "language": "python",
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "import sqlite3\n\ndbname = 'sqlite3.db'\n\ndef get_todo():\n    conn = sqlite3.connect(dbname)\n    cur = conn.cursor()\n    cur.execute('SELECT * FROM todo')\n    rows = cur.fetchall()\n    conn.commit()\n    cur.close()\n    conn.close()\n    return rows\n\ndef save_todo(task):\n    conn = sqlite3.connect(dbname)\n    cur = conn.cursor()\n    cur.execute('INSERT INTO todo(task) VALUES (?)',(task,))\n    conn.commit()\n    cur.close()\n    conn.close()\n\ndef delete_todo(id):\n    conn = sqlite3.connect(dbname)\n    cur = conn.cursor()\n    cur.execute('DELETE FROM todo WHERE id = ?',(id,))\n    conn.commit()\n    cur.close()\n    conn.close()\n\ndef check_todo(isAchieved, id):\n    conn = sqlite3.connect(dbname)\n    cur = conn.cursor()\n    cur.execute('UPDATE todo SET isAchieved = ? WHERE id = ?',(isAchieved, id))\n    conn.commit()\n    cur.close()\n    conn.close()",
          "href": null
        }
      ]
    },
    "order": 0
  },
  {
    "id": "272a501ef33781cf88e3f26ab71d4bbc",
    "type": "callout",
    "parentId": "272a501ef337811c8b94c8697bb7dcfa",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "color": "default_background",
      "icon": {
        "type": "external",
        "external": {
          "url": "https://www.notion.so/icons/code_gray.svg"
        }
      },
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "db.py",
          "href": null
        }
      ]
    },
    "order": 4
  },
  {
    "id": "272a501ef3378172b74de46a70c7965e",
    "type": "code",
    "parentId": "272a501ef33781cf88e3f26ab71d4bbc",
    "curriculumId": "272a501ef3378040af9bfae333f7427a",
    "pageId": "272a501ef337811c8b94c8697bb7dcfa",
    "data": {
      "caption": [],
      "language": "python",
      "parent": [
        {
          "annotations": {
            "bold": false,
            "code": false,
            "color": "default",
            "italic": false,
            "strikethrough": false,
            "underline": false
          },
          "plain_text": "import sqlite3\n\ndef init_db():\n    dbname = 'sqlite3.db'\n    conn = sqlite3.connect(dbname)\n    cur = conn.cursor()\n    cur.execute(\n        'CREATE TABLE IF NOT EXISTS todo(id INTEGER PRIMARY KEY AUTOINCREMENT, task STRING, isAchieved BOOLEAN DEFAULT FALSE, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)')\n    conn.commit()\n    cur.close()\n    conn.close()",
          "href": null
        }
      ]
    },
    "order": 0
  }
]
